# Production overlay: enforce Single Entrypoint invariant
# Use with: docker compose -f docker-compose.yml -f docker-compose.prod.yml up -d
# This file removes published host ports for all services except tentaculo_link
# to ensure only the gateway is externally reachable (P0 security fix).

services:
  madre:
    ports: null

  switch:
    ports: null

  hermes:
    ports: null

  hormiguero:
    ports: null

  manifestator:
    ports: null

  mcp:
    ports: null

  shubniggurath:
    # internal only; ensure no host port is published in prod
    ports: null

  spawner:
    ports: null

  operator-backend:
    ports: null

  redis:
    ports: null
# Note: tentaculo_link keeps its port mapping in the base compose file
# to remain the single external entrypoint (8000). For production, run
# with this overlay and verify with `docker compose ps` that only
# tentaculo_link shows a published port.
