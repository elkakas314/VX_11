switch/ga_router.py:21:from switch.hermes import get_metrics_collector
switch/hermes_shub_registration.py:17:log = logging.getLogger("vx11.hermes.shub_registration")
switch/hermes_shub_registration.py:205:def get_hermes_shub_registrar() -> HermesShubRegistrar:
switch/hermes/main.py:4:- GET /hermes/available
switch/hermes/main.py:5:- POST /hermes/register_model
switch/hermes/main.py:6:- POST /hermes/execute
switch/hermes/main.py:71:# Simple in-memory job store for hermes exec jobs (minimal test-friendly)
switch/hermes/main.py:77:@app.post("/hermes/exec")
switch/hermes/main.py:78:async def hermes_exec(req: dict, _: bool = Depends(_token_guard)):
switch/hermes/main.py:96:@app.get("/hermes/job/{job_id}")
switch/hermes/main.py:97:async def hermes_job_status(job_id: str, _: bool = Depends(_token_guard)):
switch/hermes/main.py:120:@app.get("/hermes/available")
switch/hermes/main.py:121:async def hermes_available(_=Depends(_token_guard)):
switch/hermes/main.py:171:        write_log("hermes", f"prune_error:{exc}")
switch/hermes/main.py:177:_ALLOWED_BASE = str(REPO_ROOT / "data" / "runtime" / "hermes_allowed")
switch/hermes/main.py:182:async def hermes_health():
switch/hermes/main.py:184:    return {"status": "ok", "module": "hermes", "version": "minimal"}
switch/hermes/main.py:188:async def hermes_waveform(body: Dict[str, Any], _: bool = Depends(_token_guard)):
switch/hermes/main.py:210:        write_log("hermes", f"waveform_error:{e}", level="ERROR")
switch/hermes/main.py:215:async def hermes_spectrogram(body: Dict[str, Any], _: bool = Depends(_token_guard)):
switch/hermes/main.py:255:                provider="hermes",
switch/hermes/main.py:260:        ent.provider = "hermes"
switch/hermes/main.py:308:def get_hermes_shub_registrar():
switch/hermes/main.py:313:def get_hermes_core():
switch/hermes/main.py:318:async def initialize_hermes():
switch/hermes/main.py:323:@app.post("/hermes/register_model")
switch/hermes/main.py:341:        write_log("hermes", f"register_error:{exc}", level="ERROR")
switch/hermes/main.py:347:@app.post("/hermes/execute")
switch/hermes/main.py:348:async def hermes_execute(req: ExecuteRequest, _: bool = Depends(_token_guard)):
switch/hermes/main.py:354:        return {"status": "accepted", "engine": "hermes", "payload": payload}
switch/hermes/main.py:356:        write_log("hermes", f"execute_error:{exc}", level="ERROR")
switch/hermes/main.py:367:@app.post("/hermes/overwrite_from_deepseek")
switch/hermes/main.py:422:        write_log("hermes", f"deepseek_overwrite_error:{e}", level="ERROR")
switch/hermes/main.py:426:@app.get("/hermes/list")
switch/hermes/main.py:443:@app.get("/hermes/catalog/summary")
switch/hermes/main.py:476:@app.post("/hermes/register_model")
switch/hermes/main.py:508:        write_log("hermes", f"registered_model:{body.name}")
switch/hermes/main.py:514:@app.post("/hermes/search_models")
switch/hermes/main.py:520:@app.post("/hermes/sync")
switch/hermes/main.py:559:@app.post("/hermes/reindex")
switch/hermes/main.py:620:        write_log("hermes", f"cli_registered:{name}")
switch/hermes/main.py:628:        write_log("hermes", f"cli_register_error:{e}", level="ERROR")
switch/hermes/main.py:634:@app.post("/hermes/register/local_model")
switch/hermes/main.py:675:        write_log("hermes", f"local_model_registered:{name}")
switch/hermes/main.py:682:@app.post("/hermes/register/shub")
switch/hermes/main.py:696:        registrar = get_hermes_shub_registrar()
switch/hermes/main.py:699:        write_log("hermes", f"shub_registration:{result.get('status')}")
switch/hermes/main.py:703:        write_log("hermes", f"shub_registration_error:{exc}", level="ERROR")
switch/hermes/main.py:707:@app.get("/hermes/shub/health")
switch/hermes/main.py:720:        registrar = get_hermes_shub_registrar()
switch/hermes/main.py:726:        write_log("hermes", f"shub_health_error:{exc}", level="ERROR")
switch/hermes/main.py:740:        write_log("hermes", f"local_model_register_error:{e}", level="ERROR")
switch/hermes/main.py:746:@app.post("/hermes/discover")
switch/hermes/main.py:786:                write_log("hermes", f"discovery_register_error:{e}", level="WARNING")
switch/hermes/main.py:790:            "hermes",
switch/hermes/main.py:801:        write_log("hermes", f"discover_error:{e}", level="ERROR")
switch/hermes/main.py:814:async def _hermes_background_tasks():
switch/hermes/main.py:822:    write_log("hermes", "background_worker_started")
switch/hermes/main.py:844:                write_log("hermes", f"background_reset_completed:hour={hour}")
switch/hermes/main.py:848:            write_log("hermes", f"background_worker_error:{e}", level="ERROR")
switch/hermes/main.py:855:    global _hermes_core
switch/hermes/main.py:856:    _hermes_core = get_hermes_core()
switch/hermes/main.py:857:    await initialize_hermes()
switch/hermes/main.py:858:    asyncio.create_task(_hermes_background_tasks())
switch/hermes/__init__.py:4:import time so `from switch.hermes import CLISelector` works during `switch`
switch/hermes/__init__.py:11:from .hermes_core import HermesCore, get_hermes_core, initialize_hermes
switch/hermes/__init__.py:26:    "get_hermes_core",
switch/hermes/__init__.py:27:    "initialize_hermes",
switch/hermes/model_scanner.py:20:logger = logging.getLogger("switch.hermes.model_scanner")
switch/hermes/model_scanner.py:91:                write_log("hermes", f"scan_error:{scan_path}:{e}", level="WARN")
switch/hermes/model_scanner.py:93:        write_log("hermes", f"scan_complete:found={len(models)}")
switch/hermes/model_scanner.py:171:        write_log("hermes", f"register_models:{result}")
switch/hermes/model_scanner.py:206:                write_log("hermes", f"enforce_limits:deleted:{model.name}")
switch/hermes/README.md:7:- **Servicio:** `hermes`
switch/hermes/README.md:12:- Registro y listado de modelos en SQLite (`/app/data/hermes_models.db`).
switch/hermes/README.md:20:- `GET /hermes/list`
switch/hermes/README.md:21:- `POST /hermes/register_model`
switch/hermes/README.md:22:- `POST /hermes/search_models`
switch/hermes/README.md:23:- `POST /hermes/sync`
switch/hermes/README.md:24:- `POST /hermes/reindex`
switch/hermes/README.md:25:- `GET /hermes/cli/list`
switch/hermes/README.md:26:- `GET /hermes/cli/available`
switch/hermes/README.md:27:- `POST /hermes/cli/register`
switch/hermes/README.md:28:- `POST /hermes/cli/renew` (placeholder)
switch/hermes/README.md:32:docker build -f switch/hermes/Dockerfile -t vx11-hermes:latest .
switch/hermes/README.md:33:docker run -p 8003:8003 vx11-hermes:latest
switch/hermes/README.md:38:docker compose up -d tentaculo_link hermes
switch/hermes/hermes_core.py:154:_hermes_core: Optional[HermesCore] = None
switch/hermes/hermes_core.py:157:def get_hermes_core() -> HermesCore:
switch/hermes/hermes_core.py:159:    global _hermes_core
switch/hermes/hermes_core.py:160:    if _hermes_core is None:
switch/hermes/hermes_core.py:161:        _hermes_core = HermesCore()
switch/hermes/hermes_core.py:162:    return _hermes_core
switch/hermes/hermes_core.py:165:async def initialize_hermes() -> HermesCore:
switch/hermes/hermes_core.py:167:    hermes = get_hermes_core()
switch/hermes/hermes_core.py:168:    await hermes.initialize()
switch/hermes/hermes_core.py:169:    return hermes
switch/hermes/Dockerfile:38:CMD ["python", "-m", "uvicorn", "switch.hermes.main:app", "--host", "0.0.0.0", "--port", "8003"]
switch/hermes/cli_selector.py:55:    source: str = "hermes"
switch/hermes/scanner_v2.py:23:logger = logging.getLogger("vx11.hermes.v2")
switch/hermes/scanner_v2.py:130:            write_log("hermes", f"cli_scan_completed:{registered_count}_available")
switch/hermes/scanner_v2.py:171:                        write_log("hermes", f"model_downloaded:{model_id}")
switch/hermes/scanner_v2.py:279:_hermes_v2 = None
switch/hermes/scanner_v2.py:281:def get_hermes_v2() -> HermesV2:
switch/hermes/scanner_v2.py:283:    global _hermes_v2
switch/hermes/scanner_v2.py:284:    if _hermes_v2 is None:
switch/hermes/scanner_v2.py:285:        _hermes_v2 = HermesV2()
switch/hermes/scanner_v2.py:286:    return _hermes_v2
switch/warm_up.py:26:        hermes_endpoint: str = "http://switch:8003",
switch/warm_up.py:29:        self.hermes_endpoint = hermes_endpoint
switch/warm_up.py:180:                    f"{self.hermes_endpoint}/hermes/get-engine",
switch/warm_up.py:234:                    f"{self.hermes_endpoint}/hermes/execute",
switch/hermes/registry_manager.py:13:log = logging.getLogger("switch.hermes.registry")
switch/hermes/registry_manager.py:24:        self.db = db_session or get_session("hermes")
switch/hermes/registry_manager.py:25:        self.log = logging.getLogger("switch.hermes.registry")
switch/router_v5.py:28:    - Queries HERMES /hermes/select-engine to pick best engine
switch/router_v5.py:30:    - Updates quota via HERMES /hermes/use-quota
switch/router_v5.py:34:    def __init__(self, hermes_endpoint: str = None):
switch/router_v5.py:36:        if hermes_endpoint is None:
switch/router_v5.py:37:            hermes_port = settings.PORTS.get("hermes", 8003)
switch/router_v5.py:38:            hermes_endpoint = f"http://switch:{hermes_port}"  # Use Docker hostname
switch/router_v5.py:39:        self.hermes_endpoint = hermes_endpoint
switch/router_v5.py:92:    async def _call_hermes_select(self, domain: str, context: Dict[str, Any]) -> Optional[Dict[str, Any]]:
switch/router_v5.py:93:        """Call HERMES /hermes/select-engine to pick best engine."""
switch/router_v5.py:97:                f"{self.hermes_endpoint}/hermes/select-engine",
switch/router_v5.py:106:                log.warning(f"hermes_select_failed:status={resp.status_code}")
switch/router_v5.py:109:            log.error(f"hermes_select_error:{e}")
switch/router_v5.py:112:    async def _call_hermes_quota(self, engine_id: int, tokens: int = 1) -> bool:
switch/router_v5.py:113:        """Call HERMES /hermes/use-quota to decrement quota."""
switch/router_v5.py:117:                f"{self.hermes_endpoint}/hermes/use-quota",
switch/router_v5.py:125:            log.error(f"hermes_quota_error:{e}")
switch/router_v5.py:180:        engine_info = await self._call_hermes_select(domain, context)
switch/router_v5.py:218:        quota_ok = await self._call_hermes_quota(engine_id, estimated_tokens)
switch/scoring_engine.py:49:        "hermes_cli": {
switch/scoring_engine.py:56:        "hermes_playwright": {
switch/adapters.py:42:async def hermes_call(payload: Any, context: Dict[str, Any] | None = None, **opts) -> Dict[str, Any]:
switch/adapters.py:45:    write_log("switch.adapters", f"hermes_call:start:{prompt[:80]}")
switch/adapters.py:46:    hermes_url = getattr(settings, "hermes_url", None)
switch/adapters.py:47:    if not hermes_url:
switch/adapters.py:48:        write_log("switch.adapters", "hermes_unavailable")
switch/adapters.py:49:        return {"ok": False, "engine": "hermes", "error": "hermes_unavailable"}
switch/adapters.py:53:            resp = await client.post(f"{hermes_url}/hermes/execute", json={"command": "echo", "args": prompt})
switch/adapters.py:58:                write_log("switch.adapters", f"hermes_call:ok")
switch/adapters.py:59:                return {"ok": True, "engine": "hermes", "result": out, "latency_ms": latency}
switch/adapters.py:61:                write_log("switch.adapters", f"hermes_call:http_{resp.status_code}")
switch/adapters.py:62:                return {"ok": False, "engine": "hermes", "error": f"http_{resp.status_code}"}
switch/adapters.py:64:        write_log("switch.adapters", f"hermes_call:error:{str(e)}")
switch/adapters.py:65:        return {"ok": False, "engine": "hermes", "error": str(e)}
switch/adapters.py:204:    "hermes": hermes_call,
switch/adapters.py:241:    hermes_url = getattr(settings, "hermes_url", None)
switch/adapters.py:243:        if hermes_url:
switch/adapters.py:246:                resp = await client.get(f"{hermes_url}/hermes/available")
switch/adapters.py:321:        "hermes": hermes_call,
switch/adapters.py:358:        hermes_url = getattr(settings, "hermes_url", None)
switch/adapters.py:360:            if hermes_url:
switch/adapters.py:363:                    resp = await client.get(f"{hermes_url}/hermes/available")
switch/pheromones.json:23:    "hermes_cli": {
switch/pheromones.json:30:    "hermes_playwright": {
switch/intelligence_layer.py:24:from switch.hermes import CLISelector, CLIFusion, ExecutionMode, get_metrics_collector
switch/intelligence_layer.py:101:        self._hermes_endpoint = settings.hermes_url or "http://switch:8003"
switch/intelligence_layer.py:165:            hermes_resources = await self._fetch_hermes_resources()
switch/intelligence_layer.py:198:    async def _fetch_hermes_resources(self) -> Dict[str, Any]:
switch/intelligence_layer.py:203:                    f"{self._hermes_endpoint.rstrip('/')}/hermes/resources",
switch/main.py:45:from switch.hermes import CLISelector, CLIFusion, ExecutionMode, get_metrics_collector
switch/main.py:476:throttle_limits = {"shub-audio": 5, "hermes": 10, "local": 10}
switch/main.py:655:        hermes_endpoint=settings.hermes_url or "http://switch:8003"
switch/main.py:841:@app.post("/switch/hermes/select_engine")
switch/main.py:842:async def switch_hermes_select_engine(body: Dict[str, Any]):
switch/main.py:843:    """Minimal engine selector: pick first available engine or 'hermes_local'."""
switch/main.py:845:    selection = available[0] if available else "hermes_local"
switch/main.py:856:@app.post("/switch/hermes/record_result")
switch/main.py:857:async def switch_hermes_record_result(body: Dict[str, Any]):
switch/main.py:858:    """Record result feedback from hermes/engines to scoring_state."""
switch/main.py:867:@app.get("/switch/hermes/status")
switch/main.py:868:async def switch_hermes_status():
switch/main.py:871:        "hermes": "available",
switch/main.py:875:            {"name": "hermes_local", "status": "healthy", "success_rate": 0.95}
switch/main.py:1195:                    f"{settings.hermes_url.rstrip('/')}/hermes/execute", json=payload
switch/main.py:1258:        elif model_name in ("deepseek", "hermes", "local", "deepseek_r1"):
switch/main.py:1277:                        f"{settings.hermes_url.rstrip('/')}/hermes/execute",
switch/main.py:1284:                    response["hermes"] = r.json()
switch/main.py:1287:                response["hermes_error"] = str(exc)
switch/main.py:1292:        if "hermes" in response:
switch/main.py:1293:            response["result"] = response.get("hermes")
switch/main.py:1317:                    f"{settings.hermes_url.rstrip('/')}/hermes/execute",
switch/main.py:1324:                response["hermes"] = r.json()
switch/main.py:1327:            response["hermes_error"] = str(exc)
switch/main.py:1480:            result, latency_ms, success = await _execute_hermes_task_chat(
switch/main.py:1667:async def _execute_hermes_task_chat(
switch/main.py:1675:                f"{settings.hermes_url.rstrip('/')}/hermes/execute",
switch/main.py:1944:            result, latency_ms, success = await _execute_hermes_task_chat(
switch/main.py:2113:@app.post("/switch/hermes/select_engine")
switch/main.py:2114:async def hermes_select_engine(req: RouteRequest):
switch/main.py:2130:@app.post("/switch/hermes/infer")
switch/main.py:2131:async def hermes_infer(req: RouteRequest):
switch/main.py:2140:                f"{settings.hermes_url.rstrip('/')}/hermes/execute",
switch/main.py:2147:            hermes_payload = (
switch/main.py:2153:        hermes_payload = {"status": "error", "error": str(exc)}
switch/main.py:2154:    return {"selection": selection, "hermes": hermes_payload}
