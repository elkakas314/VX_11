tentaculo_link/main_v7.py:114:    reason: str = "operator_manual"
tentaculo_link/main_v7.py:185:async def operator_api_proxy(request: Request, call_next):
tentaculo_link/main_v7.py:188:    if request.url.path.startswith("/operator/api"):
tentaculo_link/main_v7.py:197:        operator_url = settings.operator_url.rstrip("/")
tentaculo_link/main_v7.py:199:        if request_path.startswith("/operator/api/v1"):
tentaculo_link/main_v7.py:200:            upstream_path = request_path.replace("/operator/api/v1", "/api/v1", 1)
tentaculo_link/main_v7.py:202:            upstream_path = request_path.replace("/operator/api", "/api/v1", 1)
tentaculo_link/main_v7.py:203:        target_url = f"{operator_url}{upstream_path}"
tentaculo_link/main_v7.py:247:                    "service": "operator_backend",
tentaculo_link/main_v7.py:250:                    "recommended_action": "Ask Madre to open operator window",
tentaculo_link/main_v7.py:279:operator_ui_candidates = [
tentaculo_link/main_v7.py:280:    Path(__file__).parent.parent / "operator_ui" / "frontend" / "dist",
tentaculo_link/main_v7.py:281:    Path(__file__).parent.parent / "operator" / "frontend" / "dist",
tentaculo_link/main_v7.py:283:operator_ui_path = next(
tentaculo_link/main_v7.py:284:    (candidate for candidate in operator_ui_candidates if candidate.exists()), None
tentaculo_link/main_v7.py:286:if operator_ui_path:
tentaculo_link/main_v7.py:288:        "/operator/ui",
tentaculo_link/main_v7.py:289:        StaticFiles(directory=str(operator_ui_path), html=True),
tentaculo_link/main_v7.py:290:        name="operator_ui",
tentaculo_link/main_v7.py:292:    write_log("tentaculo_link", f"mounted_operator_ui:{operator_ui_path}")
tentaculo_link/main_v7.py:296:        f"WARNING: operator_ui not found: {operator_ui_candidates}",
tentaculo_link/main_v7.py:300:    @app.get("/operator/ui")
tentaculo_link/main_v7.py:301:    @app.get("/operator/ui/{path:path}")
tentaculo_link/main_v7.py:302:    async def operator_ui_missing(path: str = ""):
tentaculo_link/main_v7.py:309:# Include new operator API routes with /operator prefix
tentaculo_link/main_v7.py:312:        api_routes.events.router, prefix="/operator", tags=["operator-api"]
tentaculo_link/main_v7.py:315:        api_routes.settings.router, prefix="/operator", tags=["operator-api"]
tentaculo_link/main_v7.py:318:        api_routes.audit.router, prefix="/operator", tags=["operator-api"]
tentaculo_link/main_v7.py:321:        api_routes.metrics.router, prefix="/operator", tags=["operator-api"]
tentaculo_link/main_v7.py:324:        api_routes.rails.router, prefix="/operator", tags=["operator-api"]
tentaculo_link/main_v7.py:327:        api_routes.window.router, prefix="/operator", tags=["operator-api"]
tentaculo_link/main_v7.py:329:    write_log("tentaculo_link", "included_operator_api_routers:success")
tentaculo_link/main_v7.py:333:        f"WARNING: failed to include operator routers: {e}",
tentaculo_link/main_v7.py:350:@app.get("/operator")
tentaculo_link/main_v7.py:351:async def operator_redirect():
tentaculo_link/main_v7.py:352:    """Redirect /operator to /operator/ui/."""
tentaculo_link/main_v7.py:353:    return RedirectResponse(url="/operator/ui/", status_code=302)
tentaculo_link/main_v7.py:392:            "operator": 8011,
tentaculo_link/main_v7.py:521:@app.post("/operator/chat")
tentaculo_link/main_v7.py:522:async def operator_chat(
tentaculo_link/main_v7.py:550:    write_log("tentaculo_link", f"operator_chat:result_after_switch={result}")
tentaculo_link/main_v7.py:552:        write_log("tentaculo_link", "operator_chat:triggering_fallback_to_madre")
tentaculo_link/main_v7.py:563:    write_log("tentaculo_link", f"operator_chat:{session_id}")
tentaculo_link/main_v7.py:567:@app.post("/operator/task")
tentaculo_link/main_v7.py:568:async def operator_task(
tentaculo_link/main_v7.py:590:        source="operator",
tentaculo_link/main_v7.py:593:    write_log("tentaculo_link", f"operator_task:{req.task_type}:{session_id}")
tentaculo_link/main_v7.py:597:# ============ NEW: /operator/chat/ask (SIMPLIFIED CHAT) ============
tentaculo_link/main_v7.py:600:@app.post("/operator/chat/ask")
tentaculo_link/main_v7.py:601:async def operator_chat_ask(
tentaculo_link/main_v7.py:606:    Simplified chat endpoint (alternative to /operator/chat).
tentaculo_link/main_v7.py:610:    return await operator_chat(req, _)
tentaculo_link/main_v7.py:613:# ============ NEW: /operator/status (AGGREGATED HEALTH) ============
tentaculo_link/main_v7.py:616:@app.get("/operator/status")
tentaculo_link/main_v7.py:617:async def operator_status(_: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:702:    write_log("tentaculo_link", f"operator_status:overall={status_data['status']}")
tentaculo_link/main_v7.py:706:# ============ NEW: /operator/power/state (CURRENT POWER WINDOW STATE) ============
tentaculo_link/main_v7.py:709:@app.get("/operator/power/state")
tentaculo_link/main_v7.py:710:async def operator_power_state(_: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:723:        write_log("tentaculo_link", "operator_power_state:retrieved")
tentaculo_link/main_v7.py:727:            "tentaculo_link", f"operator_power_state:error={str(e)[:50]}", level="WARN"
tentaculo_link/main_v7.py:734:@app.get("/operator/power/status")
tentaculo_link/main_v7.py:735:async def operator_power_status(_: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:742:    write_log("tentaculo_link", "operator_power_status")
tentaculo_link/main_v7.py:746:@app.get("/operator/power/policy/solo_madre/status")
tentaculo_link/main_v7.py:747:async def operator_solo_madre_status(_: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:754:    write_log("tentaculo_link", "operator_solo_madre_status")
tentaculo_link/main_v7.py:758:@app.post("/operator/power/policy/solo_madre/apply")
tentaculo_link/main_v7.py:759:async def operator_solo_madre_apply(_: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:766:    write_log("tentaculo_link", "operator_solo_madre_apply")
tentaculo_link/main_v7.py:770:@app.post("/operator/power/service/{name}/start")
tentaculo_link/main_v7.py:771:async def operator_power_start(name: str, _: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:778:    write_log("tentaculo_link", f"operator_power_start:{name}")
tentaculo_link/main_v7.py:782:@app.post("/operator/power/service/{name}/stop")
tentaculo_link/main_v7.py:783:async def operator_power_stop(name: str, _: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:790:    write_log("tentaculo_link", f"operator_power_stop:{name}")
tentaculo_link/main_v7.py:794:@app.post("/operator/power/service/{name}/restart")
tentaculo_link/main_v7.py:795:async def operator_power_restart(name: str, _: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:802:    write_log("tentaculo_link", f"operator_power_restart:{name}")
tentaculo_link/main_v7.py:827:@app.post("/operator/inee/builder/patchset", tags=["proxy-inee"])
tentaculo_link/main_v7.py:828:async def operator_inee_builder_patchset(
tentaculo_link/main_v7.py:849:@app.post("/operator/inee/colony/register", tags=["proxy-inee"])
tentaculo_link/main_v7.py:850:async def operator_inee_colony_register(
tentaculo_link/main_v7.py:868:@app.post("/operator/inee/colony/envelope", tags=["proxy-inee"])
tentaculo_link/main_v7.py:869:async def operator_inee_colony_envelope(
tentaculo_link/main_v7.py:887:@app.get("/operator/inee/status", tags=["proxy-inee"])
tentaculo_link/main_v7.py:888:async def operator_inee_status(
tentaculo_link/main_v7.py:902:@app.get("/operator/session/{session_id}")
tentaculo_link/main_v7.py:903:async def operator_session(
tentaculo_link/main_v7.py:912:    write_log("tentaculo_link", f"operator_session_retrieved:{session_id}")
tentaculo_link/main_v7.py:1084:@app.get("/operator/snapshot")
tentaculo_link/main_v7.py:1085:async def operator_snapshot(t: int = 0, _: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:1089:    write_log("tentaculo_link", f"operator_snapshot:request:t={t}")
tentaculo_link/main_v7.py:1869:@app.get("/operator/observe")
tentaculo_link/main_v7.py:1870:async def operator_observe():
tentaculo_link/main_v7.py:1905:    write_log("tentaculo_link", "operator_observe:aggregated")
tentaculo_link/main_v7.py:1954:        write_log("tentaculo_link", f"operator_observe:trace_read_failed:{trace_exc}")
tentaculo_link/main_v7.py:1961:        "route_taken": "GET /operator/observe",
tentaculo_link/main_v7.py:1990:    operator = clients.get_client("operator-backend")
tentaculo_link/main_v7.py:1991:    if not operator:
tentaculo_link/main_v7.py:1992:        raise HTTPException(status_code=503, detail="operator_backend_unavailable")
tentaculo_link/main_v7.py:1994:    result = await operator.post("/auth/login", payload=request)
tentaculo_link/main_v7.py:2003:    operator = clients.get_client("operator-backend")
tentaculo_link/main_v7.py:2004:    if not operator:
tentaculo_link/main_v7.py:2005:        raise HTTPException(status_code=503, detail="operator_backend_unavailable")
tentaculo_link/main_v7.py:2007:    result = await operator.post("/auth/logout", payload={})
tentaculo_link/main_v7.py:2012:# ============ OPERATOR API â€” P0 NATIVE ENDPOINTS (NO operator_backend dependency) ============
tentaculo_link/main_v7.py:2015:@app.get("/operator/api/status", tags=["operator-api-p0"])
tentaculo_link/main_v7.py:2016:async def operator_api_status(_: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:2019:    Does NOT call operator_backend (archived).
tentaculo_link/main_v7.py:2039:            "operator_backend": {
tentaculo_link/main_v7.py:2051:@app.get("/operator/api/modules", tags=["operator-api-p0"])
tentaculo_link/main_v7.py:2052:async def operator_api_modules(_: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:2089:    modules["operator_backend"] = {
tentaculo_link/main_v7.py:2092:        "reason": "Operator API migrated to tentaculo_link:/operator/*",
tentaculo_link/main_v7.py:2099:@app.post("/operator/api/chat", tags=["operator-api-p0"])
tentaculo_link/main_v7.py:2100:async def operator_api_chat(
tentaculo_link/main_v7.py:2144:    limiter_key = f"operator_chat:{session_id}"
tentaculo_link/main_v7.py:2189:    cache_key = f"operator_chat_cache:{session_id}:{message_hash}"
tentaculo_link/main_v7.py:2396:@app.get("/operator/api/status", tags=["operator-api-p0"])
tentaculo_link/main_v7.py:2397:async def operator_api_status(
tentaculo_link/main_v7.py:2501:                "name": "operator-backend",
tentaculo_link/main_v7.py:2509:                "name": "operator-frontend",
tentaculo_link/main_v7.py:2536:            f"operator_api_status:success:correlation_id={correlation_id}",
tentaculo_link/main_v7.py:2566:            f"operator_api_status:error:{str(e)[:100]}",
tentaculo_link/main_v7.py:2579:@app.get("/operator/api/events", tags=["operator-api-p0"])
tentaculo_link/main_v7.py:2580:async def operator_api_events(
tentaculo_link/main_v7.py:2591:    - GET /operator/api/events?follow=true
tentaculo_link/main_v7.py:2704:@app.get("/operator/api/metrics", tags=["operator-api-p0"])
tentaculo_link/main_v7.py:2705:async def operator_api_metrics(
tentaculo_link/main_v7.py:2726:                "by_endpoint": {"/operator/api/chat": 120, ...},
tentaculo_link/main_v7.py:2755:                "/operator/api/chat": 120,
tentaculo_link/main_v7.py:2756:                "/operator/api/status": 85,
tentaculo_link/main_v7.py:2757:                "/operator/api/events": 40,
tentaculo_link/main_v7.py:2789:            f"operator_api_metrics:success:period={period}:correlation_id={correlation_id}",
tentaculo_link/main_v7.py:2811:            f"operator_api_metrics:error:{str(e)[:100]}",
tentaculo_link/main_v7.py:2824:@app.get("/operator/capabilities", tags=["operator-api-p0"])
tentaculo_link/main_v7.py:2825:async def operator_capabilities(
tentaculo_link/main_v7.py:2938:            f"operator_capabilities:success:mode={operational_mode}:correlation_id={correlation_id}",
tentaculo_link/main_v7.py:2956:            f"operator_capabilities:error:{str(e)[:100]}",
tentaculo_link/main_v7.py:2984:@app.post("/operator/api/assist/deepseek_r1", tags=["operator-api-codev"])
tentaculo_link/main_v7.py:2985:async def operator_api_assist_deepseek_r1(
tentaculo_link/main_v7.py:3112:@app.get("/operator/api/assist/deepseek_r1/status", tags=["operator-api-codev"])
tentaculo_link/main_v7.py:3113:async def operator_api_assist_deepseek_r1_status(_: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:3165:@app.post("/operator/api/chat/window/open", tags=["operator-api-powerwindows"])
tentaculo_link/main_v7.py:3166:async def operator_api_chat_window_open(
tentaculo_link/main_v7.py:3175:    POST /operator/api/chat/window/open
tentaculo_link/main_v7.py:3180:        "reason": "operator_10min_chat"
tentaculo_link/main_v7.py:3282:@app.post("/operator/api/chat/window/close", tags=["operator-api-powerwindows"])
tentaculo_link/main_v7.py:3283:async def operator_api_chat_window_close(_: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:3354:@app.get("/operator/api/chat/window/status", tags=["operator-api-powerwindows"])
tentaculo_link/main_v7.py:3355:async def operator_api_chat_window_status(_: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:3411:@app.get("/operator/api/events", tags=["operator-api-p0"])
tentaculo_link/main_v7.py:3412:async def operator_api_events(limit: int = 10, _: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:3427:@app.get("/operator/api/scorecard", tags=["operator-api-p0"])
tentaculo_link/main_v7.py:3428:async def operator_api_scorecard(_: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:3461:@app.get("/operator/api/health", tags=["operator-api-p0"])
tentaculo_link/main_v7.py:3462:async def operator_api_health(_: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:3488:@app.get("/operator/api/topology", tags=["operator-api-p0"])
tentaculo_link/main_v7.py:3489:async def operator_api_topology(_: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:3558:@app.get("/operator/api/audit", tags=["operator-api-p0"])
tentaculo_link/main_v7.py:3559:async def operator_api_audit(_: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:3571:@app.get("/operator/api/audit/{run_id}", tags=["operator-api-p0"])
tentaculo_link/main_v7.py:3572:async def operator_api_audit_detail(run_id: str, _: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:3583:@app.get("/operator/api/audit/{run_id}/download", tags=["operator-api-p0"])
tentaculo_link/main_v7.py:3584:async def operator_api_audit_download(run_id: str, _: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:3595:@app.get("/operator/api/settings", tags=["operator-api-p0"])
tentaculo_link/main_v7.py:3596:async def operator_api_settings(_: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:3598:    P0: Get current operator settings (UI preferences).
tentaculo_link/main_v7.py:3609:@app.post("/operator/api/settings", tags=["operator-api-p0"])
tentaculo_link/main_v7.py:3610:async def operator_api_settings_update(settings: dict, _: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:3612:    P0: Update operator settings (UI preferences).
tentaculo_link/main_v7.py:3623:    "/operator/api/{path:path}",
tentaculo_link/main_v7.py:3625:    tags=["operator-api-fallback"],
tentaculo_link/main_v7.py:3627:async def operator_api_fallback(path: str, _: bool = Depends(token_guard)):
tentaculo_link/main_v7.py:3629:    Fallback for unmatched /operator/api/* paths.
tentaculo_link/main_v7.py:3636:            "path": f"/operator/api/{path}",
tentaculo_link/main_v7.py:3638:                "GET  /operator/api/status",
tentaculo_link/main_v7.py:3639:                "GET  /operator/api/modules",
tentaculo_link/main_v7.py:3640:                "POST /operator/api/chat",
tentaculo_link/main_v7.py:3641:                "GET  /operator/api/events",
tentaculo_link/main_v7.py:3642:                "GET  /operator/api/scorecard",
tentaculo_link/main_v7.py:3643:                "GET  /operator/api/topology",
