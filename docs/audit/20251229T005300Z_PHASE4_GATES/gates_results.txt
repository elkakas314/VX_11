=== PHASE 4: FINAL GATES ===
Timestamp: 2025-12-28T23:52:28Z

GATE 1: SQLite Integrity
ok
ok
✓ Integrity: PASS

GATE 2: Health check (madre only)
"ok"
✓ Madre: PASS

GATE 3: Secret scan (no hardcoded secrets)
madre/main.py:1
madre/llm/deepseek_client.py:8
✓ Secrets: PASS (0 matches expected)


GATE 4: Post-task maintenance
{"status":"ok","out_dir":"/app/docs/audit/madre_power_maintenance_post_task_post_task_20251228T235240Z","db_path":"./data/runtime/vx11.db","db_size_mb":590.98,"apply_retention":true,"reason":"phase4_production_closure","sqlite":{"quick_check":0,"integrity_check":0,"foreign_key_check":0},"retention":{"status":"applied","db_path":"./data/runtime/vx11.db","plan_path":"/app/docs/audit/madre_power_maintenance_post_task_post_task_20251228T235240Z/db_retention_plan.json","result_path":"/app/docs/audit/madre_power_maintenance_post_task_post_task_20251228T235240Z/db_retention_result.json"},"backup_rotation":{"status":"ok","moved":[],"errors":[]},"regen_dbmap":{"returncode":0,"stdout":"Wrote docs/audit/DB_SCHEMA_v7_FINAL.json and docs/audit/DB_MAP_v7_FINAL.md\nintegrity: ok size_bytes 619692032\n","stderr":""},"counts":{"rc":0,"stdout":"{\n  \"tables\": [\n    {\n      \"table\": \"tasks\",\n      \"rows\": 43\n    },\n    {\n      \"table\": \"ia_decisions\",\n      \"rows\": 1\n    },\n    {\n      \"table\": \"module_health\",\n      \"rows\": 1\n    },\n    {\n      \"table\": \"model_registry\",\n      \"rows\": 1\n    },\n    {\n      \"table\": \"cli_registry\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"models_local\",\n      \"rows\": 30\n    },\n    {\n      \"table\": \"models_remote_cli\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"tokens_usage\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"task_queue\",\n      \"rows\": 134\n    },\n    {\n      \"table\": \"events\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"hijas_runtime\",\n      \"rows\": 55\n    },\n    {\n      \"table\": \"system_state\",\n      \"rows\": 6\n    },\n    {\n      \"table\": \"audit_logs\",\n      \"rows\": 10\n    },\n    {\n      \"table\": \"sandbox_exec\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"system_events\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"scheduler_history\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"engines\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"shub_projects\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"operator_jobs\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"hermes_ingest\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"madre_policies\",\n      \"rows\": 10\n    },\n    {\n      \"table\": \"madre_actions\",\n      \"rows\": 160\n    },\n    {\n      \"table\": \"forensic_ledger\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"power_events\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"feromona_events\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"hijas_state\",\n      \"rows\": 43\n    },\n    {\n      \"table\": \"drift_reports\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"cli_providers\",\n      \"rows\": 1\n    },\n    {\n      \"table\": \"local_models_v2\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"model_usage_stats\",\n      \"rows\": 10218\n    },\n    {\n      \"table\": \"switch_queue_v2\",\n      \"rows\": 10218\n    },\n    {\n      \"table\": \"daughter_tasks\",\n      \"rows\": 131\n    },\n    {\n      \"table\": \"intents_log\",\n      \"rows\": 53\n    },\n    {\n      \"table\": \"hormiga_state\",\n      \"rows\": 12\n    },\n    {\n      \"table\": \"incidents\",\n      \"rows\": 1126461\n    },\n    {\n      \"table\": \"pheromone_log\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"operator_session\",\n      \"rows\": 260\n    },\n    {\n      \"table\": \"cli_usage_stats\",\n      \"rows\": 123\n    },\n    {\n      \"table\": \"cli_onboarding_state\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"fluzo_signals\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"routing_events\",\n      \"rows\": 23\n    },\n    {\n      \"table\": \"context\",\n      \"rows\": 72\n    },\n    {\n      \"table\": \"reports\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"spawns\",\n      \"rows\": 68\n    },\n    {\n      \"table\": \"shub_tracks\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"daughters\",\n      \"rows\": 180\n    },\n    {\n      \"table\": \"operator_message\",\n      \"rows\": 206\n    },\n    {\n      \"table\": \"operator_browser_task\",\n      \"rows\": 67\n    },\n    {\n      \"table\": \"shub_analysis\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"shub_fx_chains\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"daughter_attempts\",\n      \"rows\": 180\n    },\n    {\n      \"table\": \"operator_tool_call\",\n      \"rows\": 67\n    },\n    {\n      \"table\": \"operator_switch_adjustment\",\n      \"rows\": 67\n    },\n    {\n      \"table\": \"shub_presets\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"copilot_repo_map\",\n      \"rows\": 983\n    },\n    {\n      \"table\": \"copilot_runtime_services\",\n      \"rows\": 12\n    },\n    {\n      \"table\": \"copilot_actions_log\",\n      \"rows\": 3\n    },\n    {\n      \"table\": \"copilot_workflows_catalog\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"chat_providers_stats\",\n      \"rows\": 4\n    },\n    {\n      \"table\": \"module_status\",\n      \"rows\": 11\n    },\n    {\n      \"table\": \"canonical_registry\",\n      \"rows\": 1\n    },\n    {\n      \"table\": \"canonical_docs_legacy_20251220T212937Z\",\n      \"rows\": 12\n    },\n    {\n      \"table\": \"canonical_runs\",\n      \"rows\": 8\n    },\n    {\n      \"table\": \"canonical_kv\",\n      \"rows\": 18\n    },\n    {\n      \"table\": \"canonical_docs\",\n      \"rows\": 6\n    },\n    {\n      \"table\": \"rails_map_versions\",\n      \"rows\": 1\n    },\n    {\n      \"table\": \"rails_lanes\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"rails_flow_templates\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"rails_container_blueprints\",\n      \"rows\": 0\n    },\n    {\n      \"table\": \"rails_events\",\n      \"rows\": 27\n    },\n    {\n      \"table\": \"operator_audit_runs_cache\",\n      \"rows\": 0\n    }\n  ],\n  \"total_tables\": 71,\n  \"total_rows\": 1149987,\n  \"ts\": \"20251228T235246Z\"\n}","stderr":"","cmd":["python3","scripts/audit_counts.py","./data/runtime/vx11.db"],"elapsed_ms":118},"scorecard":{"generated_ts":"20251228T235246Z","integrity":"5000","total_tables":71,"total_rows":1149987,"db_size_bytes":619692032,"backup_db_count":2,"backups_archived_count":23}}
✓ Post-task: INITIATED

GATE 5: DB regeneration
✓ DB maps regenerated

