============================= test session starts ==============================
platform linux -- Python 3.10.12, pytest-7.4.3, pluggy-1.6.0
rootdir: /home/elkakas314/vx11
configfile: pytest.ini
plugins: cov-4.1.0, asyncio-0.21.1, mock-3.15.1, anyio-3.7.1, timeout-2.4.0
asyncio: mode=auto
timeout: 15.0s
timeout method: signal
timeout func_only: False
collected 635 items / 504 deselected / 131 selected
Collected 131 tests.

tests/test_context7_v7.py .Progress: 1/131 tests (0%).Progress: 2/131 tests (1%)                                             [  1%]
tests/test_event_validation.py .Progress: 3/131 tests (2%).Progress: 4/131 tests (3%).Progress: 5/131 tests (3%)                                       [  3%]
tests/test_health_smoke.py .Progress: 6/131 tests (4%).Progress: 7/131 tests (5%)                                            [  5%]
tests/test_hermes_cli_detection.py .Progress: 8/131 tests (6%)                                     [  6%]
tests/test_hermes_cli_registry_module.py .Progress: 9/131 tests (6%)                               [  6%]
tests/test_hermes_registry_db.py .Progress: 10/131 tests (7%)                                       [  7%]
tests/test_hermes_waveform.py .Progress: 11/131 tests (8%)                                          [  8%]
tests/test_madre_spawner_v7.py .Progress: 12/131 tests (9%).Progress: 13/131 tests (9%).Progress: 14/131 tests (10%)                                       [ 10%]
tests/test_mcp_switch_integration.py ss                                  [ 12%]
tests/test_modes_transition.py .Progress: 15/131 tests (11%).Progress: 16/131 tests (12%).Progress: 17/131 tests (12%).Progress: 18/131 tests (13%).Progress: 19/131 tests (14%).Progress: 20/131 tests (15%).Progress: 21/131 tests (16%).Progress: 22/131 tests (16%).Progress: 23/131 tests (17%).Progress: 24/131 tests (18%).Progress: 25/131 tests (19%)                               [ 20%]
tests/test_operator_backend_v7.py .Progress: 26/131 tests (19%)                                      [ 21%]
tests/test_operator_db_schema_v7.py .Progress: 27/131 tests (20%)                                    [ 22%]
tests/test_operator_switch_hermes_flow.py FProgress: 28/131 tests (21%).Progress: 29/131 tests (22%)                             [ 23%]
tests/test_paso7_integration.py .Progress: 30/131 tests (22%).Progress: 31/131 tests (23%).Progress: 32/131 tests (24%).Progress: 33/131 tests (25%).Progress: 34/131 tests (25%).Progress: 35/131 tests (26%).Progress: 36/131 tests (27%)                                  [ 29%]
tests/test_phase12_fases2_10.py s                                        [ 29%]
tests/test_pnp_and_integration.py FProgress: 37/131 tests (28%).Progress: 38/131 tests (29%)FProgress: 39/131 tests (29%)                                    [ 32%]
tests/test_pnp_and_switch_integration.py .Progress: 40/131 tests (30%).Progress: 41/131 tests (31%).Progress: 42/131 tests (32%).Progress: 43/131 tests (32%).Progress: 44/131 tests (33%).Progress: 45/131 tests (34%).Progress: 46/131 tests (35%).Progress: 47/131 tests (35%).Progress: 48/131 tests (36%).Progress: 49/131 tests (37%).Progress: 50/131 tests (38%).Progress: 51/131 tests (38%).Progress: 52/131 tests (39%).Progress: 53/131 tests (40%).Progress: 54/131 tests (41%).Progress: 55/131 tests (41%).Progress: 56/131 tests (42%).Progress: 57/131 tests (43%).Progress: 58/131 tests (44%).Progress: 59/131 tests (45%).Progress: 60/131 tests (45%).Progress: 61/131 tests (46%)          [ 48%]
tests/test_reina_logic_v7.py .Progress: 62/131 tests (47%).Progress: 63/131 tests (48%).Progress: 64/131 tests (48%).Progress: 65/131 tests (49%).Progress: 66/131 tests (50%)                                       [ 52%]
tests/test_shub_autonomy_e2e.py .Progress: 67/131 tests (51%).Progress: 68/131 tests (51%).Progress: 69/131 tests (52%).Progress: 70/131 tests (53%).Progress: 71/131 tests (54%).Progress: 72/131 tests (54%).Progress: 73/131 tests (55%).Progress: 74/131 tests (56%).Progress: 75/131 tests (57%)                                [ 59%]
tests/test_shubniggurath_complete_suite.py .Progress: 76/131 tests (58%).Progress: 77/131 tests (58%)                            [ 61%]
tests/test_shubniggurath_phase2.py .Progress: 78/131 tests (59%).Progress: 79/131 tests (60%).Progress: 80/131 tests (61%)                                   [ 63%]
tests/test_switch_auto.py .Progress: 81/131 tests (61%)                                              [ 64%]
tests/test_switch_chat_and_breaker.py FProgress: 82/131 tests (62%).Progress: 83/131 tests (63%)                                 [ 65%]
tests/test_switch_deepseek.py .Progress: 84/131 tests (64%).Progress: 85/131 tests (64%)                                         [ 67%]
tests/test_switch_deepseek_staging.py .Progress: 86/131 tests (65%)                                  [ 67%]
tests/test_switch_hermes_flow.py .Progress: 87/131 tests (66%).Progress: 88/131 tests (67%)FProgress: 89/131 tests (67%).Progress: 90/131 tests (68%)                                    [ 70%]
tests/test_switch_hermes_shub_pipeline.py .Progress: 91/131 tests (69%).Progress: 92/131 tests (70%).Progress: 93/131 tests (70%).Progress: 94/131 tests (71%).Progress: 95/131 tests (72%)                          [ 74%]
tests/test_switch_hermes_v7.py .Progress: 96/131 tests (73%).Progress: 97/131 tests (74%).Progress: 98/131 tests (74%).Progress: 99/131 tests (75%).Progress: 100/131 tests (76%).Progress: 101/131 tests (77%).Progress: 102/131 tests (77%).Progress: 103/131 tests (78%).Progress: 104/131 tests (79%).Progress: 105/131 tests (80%).Progress: 106/131 tests (80%).Progress: 107/131 tests (81%).Progress: 108/131 tests (82%)                             [ 84%]
tests/test_switch_integration_v7.py .Progress: 109/131 tests (83%).Progress: 110/131 tests (83%).Progress: 111/131 tests (84%).Progress: 112/131 tests (85%).Progress: 113/131 tests (86%).Progress: 114/131 tests (87%).Progress: 115/131 tests (87%).Progress: 116/131 tests (88%)                             [ 90%]
tests/test_switch_local.py .Progress: 117/131 tests (89%)                                             [ 91%]
tests/test_switch_multiauto.py .Progress: 118/131 tests (90%).Progress: 119/131 tests (90%)                                        [ 93%]
tests/test_switch_providers.py .Progress: 120/131 tests (91%).Progress: 121/131 tests (92%)                                        [ 94%]
tests/test_switch_queue_consumer.py .Progress: 122/131 tests (93%)                                    [ 95%]
tests/test_switch_registry_enqueue.py .Progress: 123/131 tests (93%)                                  [ 96%]
tests/test_switch_scoring_breaker.py .Progress: 124/131 tests (94%).Progress: 125/131 tests (95%)                                  [ 97%]
tests/test_v2_advanced.py FProgress: 126/131 tests (96%)FProgress: 127/131 tests (96%).Progress: 128/131 tests (97%)                                            [100%]

=================================== FAILURES ===================================
__________________________ test_operator_intent_proxy __________________________
tests/test_operator_switch_hermes_flow.py:65: in test_operator_intent_proxy
    assert resp.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
____________ TestSwitchHermesEndpoints.test_select_engine_endpoint _____________
tests/test_pnp_and_integration.py:284: in test_select_engine_endpoint
    assert "profile" in data
E   AssertionError: assert 'profile' in {'decision': 'simple_pick', 'engine': 'hermes_local', 'mode': 'CRITICAL', 'status': 'ok'}
____________ TestSwitchHermesEndpoints.test_hermes_status_endpoint _____________
tests/test_pnp_and_integration.py:312: in test_hermes_status_endpoint
    assert "healthy_engines" in data
E   AssertionError: assert 'healthy_engines' in {'available_engines': [], 'hermes': 'available', 'mode': 'CRITICAL', 'status': 'ok'}
__________________________ test_switch_chat_endpoint ___________________________
tests/test_switch_chat_and_breaker.py:12: in test_switch_chat_endpoint
    assert "reply" in data
E   assert 'reply' in {'content': "{'status': 'ok', 'module': 'mock'}", 'decision': 'cli', 'latency_ms': 3, 'provider': 'ollama_local', ...}
_________________________ test_spawner_sends_callback __________________________
tests/test_switch_hermes_flow.py:84: in test_spawner_sends_callback
    asyncio.get_event_loop().run_until_complete(asyncio.sleep(0.1))
/usr/lib/python3.10/asyncio/events.py:656: in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
E   RuntimeError: There is no current event loop in thread 'MainThread'.
___________________________ test_switch_context_get ____________________________
tests/test_v2_advanced.py:17: in test_switch_context_get
    assert resp.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
__________________________ test_switch_providers_list __________________________
tests/test_v2_advanced.py:27: in test_switch_providers_list
    assert resp.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
=========================== short test summary info ============================
SKIPPED [1] tests/test_mcp_switch_integration.py:13: integration tests require running services
SKIPPED [1] tests/test_mcp_switch_integration.py:27: integration tests require running services
SKIPPED [1] tests/test_phase12_fases2_10.py:57: integration tests require running services
FAILED tests/test_operator_switch_hermes_flow.py::test_operator_intent_proxy
FAILED tests/test_pnp_and_integration.py::TestSwitchHermesEndpoints::test_select_engine_endpoint
FAILED tests/test_pnp_and_integration.py::TestSwitchHermesEndpoints::test_hermes_status_endpoint
FAILED tests/test_switch_chat_and_breaker.py::test_switch_chat_endpoint - ass...
FAILED tests/test_switch_hermes_flow.py::test_spawner_sends_callback - Runtim...
FAILED tests/test_v2_advanced.py::test_switch_context_get - assert 404 == 200
FAILED tests/test_v2_advanced.py::test_switch_providers_list - assert 404 == 200
==== 7 failed, 121 passed, 3 skipped, 504 deselected, 11 warnings in 26.28s ====
